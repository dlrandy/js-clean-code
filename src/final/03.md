##JS Clean Code 的敌人这里的敌人是指妨碍写出可靠，高效，可维护以及可用的 code 的
事物及行为。而这些敌人恰恰是 clean code 的警示器或者说是鼓动者。

警示器（敌人）：

1. JavaScript
   > 主要是它的普遍性，以及以很快的速率增长和被使用。语言本身又是富有表现性和多
   > 样性的
2. management
3. Self
4. the cargo cult

clean code 实际上是一个养成某种语法的过程和原则。现在的项目只会越 来越复杂，所以
写 clean code 要考虑 code base 的复杂性之外，还要考虑 team 和组织环境。

> 个体文化的实践是对 ship clean code 一种挑战。 它包括 ship(交付)的压力,不好的指
> 标和所有者(主人翁)意识的缺失。

- 交付的压力通常是因为最后的期限或者其他的管理者指令,这是软件世界一直 存在的恶心
  力量。对于外部的利益相关者(依赖开发人员产出的人)或者经理来说，最后期限是个好事
  。看起来提供了确定性和可说明性。但是对于做项目的人，它只能是一个强制的不受欢迎
  的损害。

  1. 交付的压力会逐渐使得 code 的质量下降
     - Documentation 没有足够的时间确保 code 和 apis 正确的记载。
     - Architecture 开发者关注最需要的改变，忽略了 code 整体的大的架构以及各个部
       分的关联。依赖开始变得迷惑。架构开始逐渐破碎，面条式 code 越来越多。
     - consistency 架构和语法都受到影响自然一致性也会受到影响。大多数的开发者都
       忙于最快交付。**都会忽略沟通以及标准的建立，这就导致了更多的不一致性**。
     - Testing 写测试需要花时间，重构的测试满足新的需求也需要时间。已有的测试可
       能就会删除或取消。新的测试又没有时间写。
     - 最佳实践 时间被压缩了，开发者开始在 code 上走捷径。不会关注软件是否符合目
       的或者说是需求。可能会跳过最佳实践，选择更快速的和 hacked 的方案。上面的
       一些问题，会进一步导致下面的问题
  2.

  - Bugginess 测试和文档的缺失，code 架构基础就会受到威胁，易碎的有 bug 的 code
    就会变成常态。code 和 API 以及 UI 的脆弱性，会给用户造成困扰。
  - unhappy users bug 的增加以及软件可用性的递减，用户的效率和快感也会消失，会迫
    使用户寻找其他高品质的替代方案
  - Burned-out developers 开发者必须持续的放弃最佳原则，开始变得精疲力尽。可能会
    在持续的工作中变得沮丧，心里健康和成就感受到威胁 **上面的这些持续的太长时间
    就会导致项目的失败** 快速交付的 code 的压力通常 是没有软件开发中的慢变性的工
    作知识。此类人认为交付了一些东西，达到了 stakeholder 的要求，就结束了。快速
    交付的 code 满足了需求，但是不意味着它遵 循了好的品质。坏品质的 code 会有很
    多连锁反应，要很长时间才能发现。几个月后 ，stakeholders 会发现品质的下降，但
    是并不会意识到是她们最一开始的压力导致的 。

    > 这种混乱的解决办法是在时间和交付以及技术债之间进行妥协。技术债是指保持
    > code base 健康和良好的运行顺序。这种妥协包括修复 bugs，写测试，重构旧的
    > module 或者整合工具改善 code 质量。

  **确保健康的 code base 的一些启发**

  >

  1. 没有测试的情况下不要交付特性或者是 bug 修复测试是一个持续性的确保 code 正确
     性的防范性技术。
  2. 经常的偿还技术债一周一次，一个月两次，试图让所有人偿还技术债。任何的 code
     都要能改善 code 健康度
  3. 和 stakeholder 定期的沟通，表达 code 和 project 健康相关的限制和代价。不要
     过度承若交付或者抛弃问题。

     **作为开发者，不能控制项目的管理。但是应该总是提出问题和拥护培养 clean code
     的过程(呵呵)**

### 度量指标

开发者感兴趣的标准： 1. 有多少个 bug 2. 这个 code 运行要用多长 时间 3. 测试覆盖
率怎么样

经理和其他人感兴趣的(邪恶的)标准：

1. commit 了多少 code
2. 交付了多少特性
3. 写了多少文档

> 如果是正常理由的话， 这些问题是好问题。code 行数在讨论是否去重构特定的类或者工
> 具的时候，如果作为复杂性的代理，则是一个好的标准。非技 术的经理可能认为写同样
> 数量的 code 花费的时间是一样的。这种疑惑源于他们对编程的 过程和混乱复杂性的粗
> 野理解

以下是好的可能的标准

1. 问题 ：我们是多产的？

不好的指标： 代码行数或者 commit 的行数

为什么是坏的指标： 因为开发人员可能确实是需要很多天解决一个重要 bug，但是只是一
行的 code。

更好的指标或者方式： 询问开发人员什么造成了产量的下降；要 team 回顾一下哪里有可
以改善的区域

2. 问题 ： 我们给用户提供价值了吗

不好的指标： 交付特性的数量

为什么是坏的指标： 用户可能会从更少高品质的特性中获得更多的利益

更好的指标或者方式：建立一个指标或者 A/B 试验来验证哪些特性是用户在使用或者喜欢
的。关注于特性的品质

3. 问题 ： 我们写的文档有用吗

不好的指标： 文档的行数

为什么是坏的指标： 开发人员可能只记录他们了解的 code 段，而不是哪些 code base 最
需要文档的地方。

更好的指标或者方式：创建指标追踪文档的使用。通过询问开发者，识别出哪些 code 正在
进行或者需要文档记录

4. 问题 ： 我们有一个测试完整的 code base 吗

不好的指标： 测试覆盖率

为什么是坏的指标： 如果只测量特定的 code 行数，是否被调用，那么使用少量的集成测
试就可以糊弄过去

更好的指标或者方式： 使用传统的 test coverage 并组合其他的指标。追踪经常产生 bug
的回归区域

5. 问题 ： 我们的 code base 容易出现 bug？

不好的指标： bug 的数量

为什么是坏的指标： app 中未使用到的 code 区域可能有很多的 bug。某些区域的 bug 没
有被报道。

更好的指标或者方式： 不要统计 bug。而是关注于用户和开发者的 happiness。优先处理
影响用户程度很重的 bug。

> 任何的指标都会受到现实的影响，不要纯基于这些指标来判断是否成功。特别要警惕指标
> 是否走在了 clean code 的反方向。一个标准追逐的太热切，可能会破坏了它最应该测量
> 的目的。古德哈特定律：在一个衡量变成了目标的时候，它就不再是一个好的标准。

- 主人翁意识的缺失

它是健康 code 的重要信条，依赖于和 code 健康相关的人 。ownership 是指一块 code
由一个人或者一组人来培育，并把 code 的持续健康和可靠 性作为重要的优先级。

危害：

1. 可靠性 code 正确性和稳定性没有持续的监控关注，随着时间不断的萎缩，code 变得易
   碎
2. 高效性 code 没有被任何人测量和关注，只是能用就好了的话，效率也会衰落
3. 可维护性非 owner 做的快速的考虑不当的改变，导致架构更难于理解，维护更难
4. code 的文档和一般可用的思考和监督的缺失，最终 code 复杂，软件难用
   > - 保证 code 可靠性 关注和监督 code 正确性和持续的稳定性
   > - 高效性 持续的测量 code 并评估效率
   > - 可维护性 code 始终保持单版本架构和语法
   > - 可用性 文档持续更新 code 可用性持续关注

组织或者管理文化会导致健康或者不健康的 code，因此很重要的是适 当沟通和倡导流程和
动力允许开发人员确保 code 干净和健康

3.self 自我意识

对于自己的工作一 定要有荣誉感和逐步把我们做的东西培养的完美。 在编程领域中，和生
活中的其他领域 已有，重点是自我意识的平衡，保持好的部分，但是不让坏的部分影响的
太多。

#### 炫耀语法

自我意识 经常能使自己变得更好.code 是通信的目的，你掌握的特殊的知识技巧，不代表
这他人和 你一样，所以写 code 时候，要考虑到他人的不同知识和能力，以致于他们可以
read 和 使用维护 code。 ** 复杂少见的语法通常是自高自大的 code 代表 ** 位操作符
是将操作数转换成 32 位的整数。意味着丢弃小数部分。对于负数的操作 clean code 依赖
于你的方式和整个 team 的方式。team 持续的决定着工具约定抽象。 可以随 意的使用语
言的能力和特性以及 side effects，但是请确保可读性，如何不能，请使用 更可读的
code。不要以简洁或者高效作为借口。code 是通信的目的，是给人看的。

#### 固执的观点

cleatcode 依赖你的方式和 team 的方式。code 的 owner team 会持续的选择工具，约定
和抽象来达到目标，所以 team 成员必须要沟通好并分享观点，并把这些观点融为一个清晰
的结果。妥协是必要的。妥协肯定是会伤害到自我意识的 **多看看他人观点，开阔自己的
眼界，不要执迷自己的观点**

#### 骗子综合征

我们只能精通一个相对比较窄的领域，很多领域是不清楚的，所以不要妄自菲薄，不要有
压力，自信一些。

不自信可能导致的后果

1. 缺乏果断性

不相信自己的能力会导致在做决定 code 的架构的时候更缺乏自信 2. 缺乏胆识魄力

的缺失导致更少冒险和更少的大胆决定，胆识有时候正是这些决定推动 了 codebase 和项
目的前进 3. 沟通的缺乏

不相信自己的观点和技能，会导致不重要的沟通发生。主要是指识别重要 的问题和足够自
信的拥护改变

4.the cargo cult code 船货崇拜 指的是在没有完全的理解 code 真正目的和功能的情况
下的拷贝模式和行为

cargo cult 一般出现在以下的过程：

1. 加入了一个不太熟悉的技术环境
2. 看到了想要模仿的效果
3. 拷贝似乎产生了想要的效果的 code

他可能不涉及 code 的直接拷贝，可能只是模式或者语 法的微妙拷贝。忙于项目的开发人
员，通常会自然而然的继承已有代码库的命名，语法和 空白约定。他们这么做也是正常的
，只是自然的反映和遵循已有模式，这是正确的实践。恰恰 这里面也是需要在每一个步骤
上批判的执行，尽量的改进项目。

**不费心思的采用已有实践，而不质疑既有实践的 持续的正确性和合适性， 对项目是有害
的**

### cargo culting tools 和库

js 世界，每个月都会有一些新的工具和库出现。这些总是带有一些好处。在确认了这些好
处之后，在没有理解这些个库或者适当的考虑这些在目前项目上的合适性，就开始使用。开
发人员在使用工具的时候，不仅仅要看流行性和新奇性，还要考虑它的工作原理以及和其他
当前方法的不同。

cult in cargo 就像是说使用了这个工具或者方式解决了所有问题。实际上是这些问题转变
成了新的问题

**技术选型** 在决定使用某个工具的时候，应该考虑一下几个问题：

- 合适性

  它是解决问题的最合适的工具吗

- 可靠性

  它运行的可靠吗？持续的可靠吗？

- 可用性

  易于使用吗？文档可以吗？

- 兼容性

  能较好的整合到已有的 codebase 里吗

- 适应性

  它能适应不断变化的需求吗

  为避免船货崇拜，戒绝奇闻谣言，而是详细的比较分析，比较和对比不同的可能性，找到
  最合适的

### 总结

clean code 不但是 code 特点，也是整个组织和我们内心或者思想都要培养的一种文化
